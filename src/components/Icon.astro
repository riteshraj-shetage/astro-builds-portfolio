---
import { icons, type IconName } from "../lib/icons";

interface Props {
  name: IconName | string;
  size?: number;
  class?: string;
  id?: string;
}

const { name, size = 24, class: className = "", id } = Astro.props;
const icon = icons[name as IconName];

if (!icon) {
  console.warn(`Icon "${String(name)}" not found in octicons`);
}

// Generate the SVG HTML. Provide sensible defaults for fill and viewBox so icons inherit text color
// and have a consistent coordinate system. Keep width/height from `size` prop.
const svgHtml = icon
  ? icon.toSVG({ width: size, height: size, fill: 'currentColor' })
  : '';

// Insert `id` and `class` attributes onto the <svg> tag in one operation to avoid multiple
// string replacements which can miss the tag after the first replacement.
let finalSvg = svgHtml;
if (svgHtml && (className || id)) {
  const attrs = `${id ? ` id="${id}"` : ''}${className ? ` class="${className}"` : ''}`;
  finalSvg = svgHtml.replace(/^<svg\b/, `<svg${attrs}`);
}
---
{finalSvg && <div set:html={finalSvg} style="display: contents;" />}
