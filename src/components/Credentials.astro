---
import { credentials } from '../data/portfolio';
---

<section id="credentials" class="section section-alt">
  <div class="container-custom">
    <div class="section-header">
      <h2 class="section-title">Credentials & Certifications</h2>
      <p class="section-subtitle">Professional certifications and verified achievements</p>
    </div>

    <div class="max-w-4xl mx-auto space-y-6">
      {credentials.map((cred, index) => (
        <div class="card-highlight animate-fade-in-up" style={`animation-delay: ${index * 0.1}s`}>
          <div class="flex items-start gap-6">
            <div class="p-3 rounded-lg bg-gh-success-subtle border border-gh-success-muted flex-shrink-0">
              <svg class="w-8 h-8 text-gh-success-fg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
              </svg>
            </div>

            <div class="flex-1">
              <div class="flex flex-col md:flex-row md:items-start md:justify-between mb-3">
                <div>
                  <h3 class="text-xl font-semibold text-gh-fg-default mb-1">{cred.title}</h3>
                  <p class="text-gh-accent-fg font-medium">{cred.issuer}</p>
                </div>
                <div class="flex flex-col items-start md:items-end gap-2 mt-2 md:mt-0">
                  <span class="badge">{cred.date}</span>
                  {cred.credentialId && (
                    <span class="text-gh-fg-muted text-xs font-mono">ID: {cred.credentialId}</span>
                  )}
                </div>
              </div>
              
              <p class="text-gh-fg-muted leading-relaxed mb-4">
                {cred.description}
              </p>

              <div class="flex flex-wrap items-center gap-3">
                {cred.certificateImage && (
                  <button 
                    class="btn btn-secondary text-sm open-modal-btn"
                    data-cert-image={cred.certificateImage}
                    data-cert-title={cred.title}
                    data-cert-issuer={cred.issuer}
                  >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                    View Certificate
                  </button>
                )}
                {cred.verificationUrl && (
                  <a 
                    href={cred.verificationUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="btn btn-secondary text-sm no-underline"
                  >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                    </svg>
                    Verify
                  </a>
                )}
              </div>
            </div>
          </div>
        </div>
      ))}
    </div>

    <div class="mt-16 text-center">
      <div class="inline-flex items-center gap-3 px-6 py-3 bg-gh-canvas-subtle border border-gh-border-default rounded-lg">
        <svg class="w-6 h-6 text-gh-success-fg animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
        <span class="text-gh-fg-muted text-sm md:text-base">
          Continuously pursuing professional certifications and skill development
        </span>
      </div>
    </div>
  </div>
</section>

<!-- Certificate Modal -->
<div id="certificate-modal" class="fixed inset-0 bg-black bg-opacity-75 z-50 hidden flex items-center justify-center p-4">
  <div class="bg-gh-canvas-subtle border border-gh-border-default rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col">
    <!-- Modal Header -->
    <div class="flex items-center justify-between p-4 border-b border-gh-border-default">
      <div>
        <h3 id="modal-title" class="text-xl font-semibold text-gh-fg-default"></h3>
        <p id="modal-issuer" class="text-sm text-gh-fg-muted"></p>
      </div>
      <button id="close-modal-btn" class="text-gh-fg-muted hover:text-gh-fg-default transition-colors">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    
    <!-- Modal Body -->
    <div class="flex-1 overflow-auto p-4">
      <img id="modal-certificate-image" src="" alt="Certificate" class="w-full h-auto rounded border border-gh-border-default" />
    </div>
  </div>
</div>

<script>
  // Modal functionality
  const modal = document.getElementById('certificate-modal');
  const modalTitle = document.getElementById('modal-title');
  const modalIssuer = document.getElementById('modal-issuer');
  const modalImage = document.getElementById('modal-certificate-image') as HTMLImageElement;
  const closeBtn = document.getElementById('close-modal-btn');
  const openBtns = document.querySelectorAll('.open-modal-btn');

  openBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
      const target = e.currentTarget as HTMLElement;
      const certImage = target.getAttribute('data-cert-image') || '';
      const certTitle = target.getAttribute('data-cert-title') || '';
      const certIssuer = target.getAttribute('data-cert-issuer') || '';
      
      if (modalTitle && modalIssuer && modalImage && modal) {
        modalTitle.textContent = certTitle;
        modalIssuer.textContent = certIssuer;
        modalImage.src = certImage;
        modal.classList.remove('hidden');
        modal.classList.add('flex');
      }
    });
  });

  const closeModal = () => {
    if (modal) {
      modal.classList.add('hidden');
      modal.classList.remove('flex');
    }
  };

  if (closeBtn) {
    closeBtn.addEventListener('click', closeModal);
  }

  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });
  }

  // Close modal on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && modal && !modal.classList.contains('hidden')) {
      closeModal();
    }
  });
</script>
